const { join } = require('path')
const cds = require('../../../cds')
const { read } = cds.utils
const mvn = require('../../util/mvn')
const { readProject } = require('../../util/projectReader')
const { mergeJSON } = require('../../util/merge')

module.exports = class SQLiteTemplate extends require('../templateBase') {

    async run() {
      const project = await readProject()
      const { isNodejs, isJava, configFile } = project
      if (isNodejs) {
        project.shortcut = !(await read(configFile)).cds?.requires?.db?.kind
        await mergeJSON(configFile, join(__dirname, 'files', `package.json.hbs`), project)
      } else if (isJava) {
        await mvn.add('sqlite')
      }
    }
}
